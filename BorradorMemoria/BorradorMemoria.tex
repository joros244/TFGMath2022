\documentclass[12pt, a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{lmodern}

\usepackage[spanish,es-noshorthands]{babel}

\usepackage{amsmath,amssymb,amsthm}
\usepackage{amsfonts}
\usepackage{authblk}
\usepackage{mathtools}

\usepackage{graphicx}
\graphicspath{{Images/}}
\usepackage{float}
\usepackage{fullpage}
\parskip = 2pt plus 1.5pt minus 1pt
\usepackage{tikz}
\usetikzlibrary{positioning}
\usetikzlibrary{babel}
\pgfdeclarelayer{background}
\pgfdeclarelayer{foreground}
\pgfsetlayers{background,main,foreground}

\newcommand\hlightr[1]{\tikz[overlay, remember picture,baseline=-
\the\dimexpr\fontdimen22\textfont2\relax]\node[rectangle,fill=red!50,rounded 
corners,fill opacity = 0.2,draw,thick,text opacity =1] {$#1$};}

\numberwithin{equation}{section}

\theoremstyle{definition}
\newtheorem{defi}{Definición}
\newtheorem{ejemplo}{Ejemplo}
\newenvironment{ejem}
  {\pushQED{\qed}\renewcommand{\qedsymbol}{$\blacktriangleleft$}\ejemplo}
  {\popQED\endejemplo}

\theoremstyle{remark}
\newtheorem*{remark}{Nota}

\theoremstyle{plain}
\newtheorem{prop}{Proposición}

\title{Sobre la homología persistente en redes neuronales}


\author{José Manuel Ros Rodrigo}

\affil{Facultad de Ciencia y Tecnología\\
  Universidad de La Rioja}

\date{Abril 2022}

\begin{document}
	
	\maketitle
	
	\newpage
	
	\begin{abstract}
	(En construcción.)
	\end{abstract}
	
	\newpage

	\tableofcontents

	\newpage

	\section{Introducción}
	(En construcción.)

	\newpage

	\section{Preeliminares}

	A lo largo de este capítulo vamos a ver todas las nociones teóricas 
	necesarias para el uso de la homología persistente en redes neuronales.	
	
	\subsection{Complejos simpliciales}
	Comenzamos con el primer concepto fundamental de todo el trabajo, los 
	\emph{complejos simpliciales}. Esta noción admite dos enfoques 
	diferentes, por lo que debemos dintinguir entre dos definiciones 
	equivalentes: los complejos simpliciales \emph{abstractos} y los 
	complejos simpliciales \emph{geométricos}.

	Siguiendo el enfoque combinatorio, comenzamos definiendo los complejos 
	simpliciales abstractos y algunas nociones relacionadas. 

	\begin{defi}
	
	Un \textit{complejo simplicial abstracto} es una colección, 
	\begin{Large}$\nu$\end{Large}, de subconjuntos no vacíos de un 
	conjunto, {\Large $\nu$}$_{0}$, que verifica las siguientes 
	propiedades:
	
	\begin{enumerate}
		\item Si $v \in $ {\Large $ \nu$}$_{0}$, entonces $\{v\} \in$
			\begin{Large}$ \nu$\end{Large}
		\item Si $\sigma \in $ {\Large $ \nu$}$ \text{ y } \tau 
			\subset \sigma$, entonces $ \tau \in $
			\begin{Large}$ \nu$\end{Large}
	\end{enumerate}
	
	A los elementos de {\Large $\nu$} los llamaremos \textit{símplices},
	más concretamente: dado $\sigma \in $ {\Large $\nu$}, diremos que 
	$\sigma$ tiene \textit{dimensión p}, y que $\sigma$ es un 
	\textit{p-símplice}, si $|\sigma|=p+1$. Asimismo, definimos la 
	\textit{dimensión de {\Large $\nu$}} como el máximo de las dimensiones 
	de sus símplices y denotaremos por {\Large $\nu$}$_{p}$ a la colección 
	de los p-símplices de {\Large $\nu$}.	
	
	\end{defi}
	
	En relación con el concepto de símplice y de dimensión surge la 
	siguiente noción: 

	\begin{defi}
		Sean $\sigma$ y $\tau$ dos símplices de {\Large $\nu$} tales 
		que $\tau \subset \sigma$. Entonces diremos que $\tau$ es una 
		\textit{cara} de $\sigma$, y si las dimensiones de $\sigma$ y 
		$\tau$ difieren por a, diremos que $\tau$ es una cara de 
		$\sigma$ de \textit{codimensión a}.
	\end{defi}

	Ahora que hemos definido los complejos simpliciales abstractos veamos 
	un pequeño ejemplo para fijar ideas.

	\begin{ejem}
		Supongamos el siguiente complejo simplicial abstracto:
		\begin{multline*} 
			\text{{\Large $\nu$}}=\{\{a\},\{b\},\{c\},\{d\},
			\{a,b\},\{a,c\},\{a,d\},\{b,c\},\{b,d\},\{c,d\},
			\{a,b,c\},\{a,b,d\},\\
			\{a,c,d\},\{a,b,c,d\}\}
		\end{multline*}
		Así, tenemos que la dimensión de {\Large $\nu$} es 3. También 
		observamos que el 3-símplice $\{a,b,c,d\}$ tiene por caras de 
		codimensión 1 a los 2-símplices $\{a,b,c\},\{a,b,d\}$ y 
		$\{a,c,d\}$. Veamos su representación geométrica.

		\begin{figure}[H]
			\centering
			\begin{tikzpicture}
				%Nodes
				\coordinate      (a) 	at 	(4.5,2.5);
				\coordinate      (b) 	at 	(3,0.8);
				\coordinate     (c) 	at 	(4.4,0.1);
				\coordinate      (d) 	at 	(6,0.8);
				
				%Lines
		    		\draw[thick, fill=black!20] (a) -- (b) -- (c) -- (d) -- cycle;
				\draw[thick, dashed] (b) -- (d);
				\draw[thick] (a) -- (c);

				\fill[black!20, draw=black, thick] (a) circle (3pt) node[black, above right] {a};
				\fill[black!20, draw=black, thick] (b) circle (3pt) node[black, above left] {b};
				\fill[black!20, draw=black, thick] (c) circle (3pt) node[black, below right] {c};
				\fill[black!20, draw=black, thick] (d) circle (3pt) node[black, above right] {d};

			\end{tikzpicture}
			\caption{Representación geométrica del complejo 
			simplicial {\Large $\nu$}.}
		\end{figure}

		Esta representación es única salvo homeomorfismo. Observamos 
		que interpretando {\Large $\nu$} como un subconjunto de 
		$\mathbb{R}^{n}$ obtenemos un tetraedro. Esta idea motiva el 
		otro enfoque de los complejos simpliciales: el enfoque 
		geométrico.
	\end{ejem}

	Siguiendo el enfoque geométrico es necesario que, antes de llegar a la
	definición de complejo simplicial geométrico, veamos unos conceptos 
	previos relacionados con la propia definición.

	\begin{defi}
		Sean $\{u_{0},u_{1},...,u_{k}\}\subset\mathbb{R}^{n}$. Diremos
		que los k+1 puntos son \textit{afínmente independientes} si 
		los k vectores $u_{1}-u_{0},u_{2}-u_{0},...,u_{k}-u_{0}$ son
		linealmente independientes.

		Sea $x \in \mathbb{R}^{n}$. Diremos que $x$ es una 
		\textit{combinación afín} de los $u_{i}$ si $\exists 
		\lambda_{0},...,\lambda_{k}$ tales que 
		$x=\sum_{i=0}^{k}\lambda_{i}u_{i}$ y 
		$\sum_{i=0}^{k}\lambda_{i}=1$
	\end{defi}

	\begin{defi}
		Sean $\{u_{0},u_{1},...,u_{k}\}\subset\mathbb{R}^{n}$ k+1 
		puntos afínmente independientes y $x=\sum_{i=0}^{k}
		\lambda_{i}u_{i}$ una combinación afín. Diremos que $x$ es una
		\textit{combinación convexa} de los $u_{i}$ si todos los 
		$\lambda_{i}$ son no negativos.

		Definimos la \textit{clausura convexa} de los $u_{i}$ como el
		conjunto de todas sus posibles combinaciones convexas.
	\end{defi}

	Ahora que ya contamos con estas nociones previas pasamos a definir la 
	pieza clave en la definición de complejo simplicial geométrico: el 
	\emph{símplice}.

	\begin{defi}
		Definimos un \textit{k-símplice} como la clausura convexa de 
		k+1 puntos afínmente independientes. Lo denotaremos por 
		$\sigma=conv\{u_{0},u_{1},...,u_{k}\}$, y diremos que la 
		\textit{dimensión de $\sigma$} es k.

		Llamamos \textit{cara} de $\sigma$ a cualquier combinación 
		convexa de un subconjunto no vacío de los $u_{i}$. Lo 
		denotaremos por $\leq$.

		Para los casos $k=0,1,2,3$ diremos que $\sigma$ es un vértice,
		arista, triángulo, tetraedro respectivamente.
	\end{defi}

	Habiendo definido todos los conceptos previos necesarios pasamos a 
	definir \emph{complejo simplicial geométrico}.

	\begin{defi}
		Llamamos \textit{complejo simplicial geométrico} a la 
		colección finita de símplices {\Large $\nu$} verificando las
		siguientes propiedades:
		\begin{enumerate}
			\item Si $\sigma\in \text{{\Large $\nu$} y }
				\tau \leq \sigma \implies \tau \in 
				\text{{\Large $\nu$}}$
			\item Si $\sigma_{1},\sigma_{2} \in 
				\text{{\Large $\nu$}} \implies 
				\sigma_{1}\cap\sigma_{2}=\emptyset \text{ o }
				\sigma_{1}\cap\sigma_{2} \text{ es una cara 
				común a ambos.}$
		\end{enumerate}
	\end{defi}
	
	De aquí en adelante emplearemos la definición de complejo simplicial 
	abstracto, pues es la más adecuada para el presente trabajo.

	Ahora que ya hemos definido los objetos con los que vamos a trabajar, 
	procedemos a definir las aplicaciones entre ellos.
	\begin{defi}
		Una \textit{aplicación entre complejos simpliciales}, 
		$f:\text{{\Large $\nu$}} \rightarrow \text{{\Large 
		$\nu$}$^{\prime}$}$, es una aplicación $f:\text{{\Large 
		$\nu$}$_{0}$} \rightarrow \text{{\Large $\nu$}$_{0}^{\prime}$}$ 
		tal que $f(\sigma) \in \text{{\Large $\nu$}$^{\prime}$} 
		\hspace{5pt} \forall \sigma \in \text{{\Large $\nu$}}$.
	\end{defi}
	
	Teniendo definidas las aplicaciones entre complejos simpliciales, 
	vamos a dotar a los complejos simpliciales de una cierta estructura 
	que será de lo más útil para los propósitos del presente trabajo.

	Consideremos $\mathbb{Z}_{2}$ el cuerpo de dos elementos. Dado un 
	complejo simplicial {\Large $\nu$}, denotaremos por 
	$C_{p}(\text{{\Large $\nu$}})$ al $\mathbb{Z}_{2}$-espacio vectorial
	libre cuya base viene dada por los p-símplices de {\Large $\nu$}. 
	Ahora, para cualquier $p \in \{1,2,...\}$ definimos la siguiente 
	aplicación: 
	\begin{equation}
		\label{def:borde}
		\begin{array}{lll}
			\partial_{p}:C_{p}(\text{{\Large $\nu$}}) & 
				\rightarrow & C_{p-1}(\text{{\Large $\nu$}})
				\\[3pt] 
			\multicolumn{1}{r}{c} & \mapsto & \displaystyle 
				\sum_{\mathclap{d \subset c,d \in 
				\text{{\large $\nu$}}_{p-1}}}d
		\end{array} 
	\end{equation}
	Si $p=0$ definimos $\partial_{0}=0$. Intuitivamente, $\partial_{p}$ le
	asigna a cada p-símplice su borde, esto es, la suma de sus caras de
	codimensión 1. Esta aplicación tiene una propiedad muy importante, 
	que motivará la siguiente subsección:

	\begin{prop}
		Sea $\partial_{p}$ definida como en \ref{def:borde}. Entonces 
		para todo $p \in \{0,1,2,..\}$ $\partial_{p}\circ 
		\partial_{p+1}=0$. Coloquialmente, <<el borde del borde es 
		vacío>>.
	\end{prop}
	\begin{proof}
		Sea $c \in C_{p+1}(\text{{\Large $\nu$}})\text{ y }v\in 
		\text{{\Large $\nu$}}$ el símplice representado por $c$. 
		Veamos que $\partial_{p}(\partial_{p+1}(c))=0$.

		En efecto, notemos que $v$ posee $\binom{p+2}{p}$ 
		caras distintas de codimensión 2. Sea $\tau$ una de ellas, es 
		decir, $\tau$ es un p-1-símplice y $\tau \subset v$.

		Si probamos que $\tau$ aparece en 2 caras de codimensión 1 de 
		$v$ habremos terminado, pues aparecerá 2 veces como vector al 
		hacer $\partial_{p}(\partial_{p+1}(c))$ y como estamos en 
		$\mathbb{Z}_{2}$ se anulará. Esto implica lo que queremos
		probar.

		Observemos que $\tau$ tiene dimensión p mientras que $v$ tiene
		dimensión p+2. Por lo tanto, supongamos, sin pérdida de 
		generalidad, que $\tau$ viene dado por los p últimos elementos 
		de $v$. Así, tenemos dos elementos libres en $v$, y al 
		calcular las caras de codimensión 1 de $v$, con los p últimos 
		elementos fijos, tendremos únicamente 2 caras que contienen a
		$\tau$.  	
	\end{proof}
	\begin{remark}
		La elección del cuerpo sobre el que se toman los espacios 
		vectoriales es muy significativa. De hecho, si escogemos otro 
		cuerpo, los resultados serán muy distintos, y los cálculos 
		para llegar a ellos, serán más engorrosos. Veremos este hecho 
		en los siguientes ejemplos.
	\end{remark}

	Veamos un ejemplo que ilustre la proposición anterior, es decir, que 
	<<el borde del borde es vacío>>.

	\begin{ejem}
		Supongamos el complejo simplicial {\Large $\nu$} del ejemplo 
		anterior y $\sigma = \{a,b,c\} \in \text{{\Large $\nu$}}$.

		Así pues, tendremos $c \in C_{2}(\text{{\Large $\nu$}})$, con
		$c=\begin{pmatrix}
			1 \\
			0 \\
			0 
		\end{pmatrix}$ la representación de $\sigma$ en $C_{2}(
		\text{{\Large $\nu$}})$. Ahora expresamos las aplicaciones 
		$\partial_{2}$ y $\partial_{1}$ en forma matricial:
		\begin{equation*}
			\partial_{2}= \begin{pmatrix}
				1 & 1 & 0 \\
				1 & 0 & 1 \\
				0 & 1 & 1 \\
				1 & 0 & 0 \\
				0 & 1 & 0 \\
				0 & 0 & 1
			\end{pmatrix}
			\hspace{0.5cm}\text{y}\hspace{0.5cm}
			\partial_{1}= \begin{pmatrix}
				1 & 1 & 1 & 0 & 0 &0 \\
				1 & 0 & 0 & 1 & 1 &0 \\
				0 & 1 & 0 & 1 & 0 &1 \\
				0 & 0 & 1 & 0 & 1 &1
			\end{pmatrix}
		\end{equation*}
		Ahora, teniendo en cuenta que estamos operando en un cuerpo de 
		característica 2, hacemos $\partial_{1}(\partial_{2}(c))$:
		\begin{equation*}
			\begin{split}
				\partial_{1}(\partial_{2}(c))=\begin{pmatrix}
				1 & 1 & 1 & 0 & 0 &0 \\
				1 & 0 & 0 & 1 & 1 &0 \\
				0 & 1 & 0 & 1 & 0 &1 \\
				0 & 0 & 1 & 0 & 1 &1
			\end{pmatrix}\cdot \Bigg( 
				\begin{pmatrix}
				1 & 1 & 0 \\
				1 & 0 & 1 \\
				0 & 1 & 1 \\
				1 & 0 & 0 \\
				0 & 1 & 0 \\
				0 & 0 & 1
				\end{pmatrix}
				\cdot
				\begin{pmatrix}
				1 \\
				0 \\
				0 
				\end{pmatrix} \Bigg ) = \\
				=\begin{pmatrix}
				1 & 1 & 1 & 0 & 0 &0 \\
				1 & 0 & 0 & 1 & 1 &0 \\
				0 & 1 & 0 & 1 & 0 &1 \\
				0 & 0 & 1 & 0 & 1 &1
				\end{pmatrix}
				\cdot
				\begin{pmatrix}
				1 \\
				1 \\
				0 \\
				1 \\
				0 \\
				0
				\end{pmatrix} =
				\begin{pmatrix}
                                0 \\
				0 \\
				0 \\
				0
				\end{pmatrix}=
				\vec{0}
			\end{split}
		\end{equation*}
		Hemos comprobado que, en efecto, <<el borde del borde>> de 
		$\sigma$ es 0. Para comprobarlo para cualquier vector bastará 
		observar que:
		\begin{equation*}
		\begin{pmatrix}
				1 & 1 & 1 & 0 & 0 &0 \\
				1 & 0 & 0 & 1 & 1 &0 \\
				0 & 1 & 0 & 1 & 0 &1 \\
				0 & 0 & 1 & 0 & 1 &1
			\end{pmatrix}\cdot 
				\begin{pmatrix}
				1 & 1 & 0 \\
				1 & 0 & 1 \\
				0 & 1 & 1 \\
				1 & 0 & 0 \\
				0 & 1 & 0 \\
				0 & 0 & 1
				\end{pmatrix}
				=
				\begin{pmatrix}
				0 & 0 & 0 \\
				0 & 0 & 0 \\
				0 & 0 & 0 \\
				0 & 0 & 0 
				\end{pmatrix}
		\end{equation*}
		En este ejemplo apreciamos lo significativo de elegir el 
		cuerpo $\mathbb{Z}_{2}$, pues en otro caso, los productos 
		matriciales son más difíciles de calcular y podrían no 
		anularse.
	\end{ejem}

	De la proposición anterior se desprende que $Im(\partial_{p+1}) 
	\subset Ker(\partial_{p})$. Este hecho motiva la siguiente noción 
	importante del presente trabajo: los \emph{grupos de homología}.
 
	\newpage

	\subsection{Homología. Homología persistente}
	
	En la subsección anterior, más concretamente en \ref{def:borde}, hemos 
	introducido la aplicación <<borde>>. A lo largo de esta subsección 
	vamos a profundizar más en ella, y en los espacios sobre los que está
	definida, llegando de una manera natural a la definición de 
	\emph{grupo de homología}.

	En primer lugar, vamos a centrarnos en 
	$C_{p}(\text{{\Large $\nu$}})$ y sus elementos.

	Tal y como hemos mencionado anteriormente, podemos ver 
	$C_{p}(\text{{\Large $\nu$}})$ como un $\mathbb{Z}_{2}$-espacio 
	vectorial libre cuya base viene dada por los p-símplices de 
	{\Large $\nu$}. Así, si $c \in C_{p}(\text{{\Large $\nu$}})$, entonces
	$c$ es un vector que representa a un p-símplice $v$. De esta manera,
	podemos ver $v$ como suma de los p-símplices de las componentes no 
	nulas de $c$. Más formalmente:

	\begin{defi}
		Sea {\Large $\nu$} un complejo simplicial y $p \in \mathbb{N}
		\cup\{0\}$ 
		tal que $p\leq dim \text{{\Large $\nu$}}$. Una 
		\textit{p-cadena} es una suma formal de p-símplices de 
		{\Large $\nu$}.
	\end{defi}
	
	Con la noción de p-cadena, ya podemos formalizar la definición de 
	$C_{p}(\text{{\Large $\nu$}})$. 

	\begin{defi}
		Sea {\Large $\nu$} un complejo simplicial abstracto. Definimos
		el \textit{grupo de p-cadenas} de {\Large $\nu$} como el 
		conjunto de todas las p-cadenas de 
		{\Large $\nu$}, con la operación suma componente a componente 
		con coeficientes en $\mathbb{Z}_{2}$. Lo denotaremos por 
		$(C_{p}(\text{{\Large $\nu$}}), +)$ o simplemente 
		$C_{p}(\text{{\Large $\nu$}})$.
	\end{defi}

	De la definición anterior se desprende el siguiente resultado:

	\begin{prop}
		\label{prop:abel}
		Sea {\Large $\nu$} un complejo simplicial abstracto. Para cada 
		$p \in \mathbb{N}\cup\{0\}$ tal que $p \leq dim\text{{\Large $\nu$}}$, 
		entonces $(C_{p}(\text{{\Large $\nu$}}), +)$ es grupo 
		abeliano.
	\end{prop}

	\begin{proof}
		La asociatividad se tiene por herencia de la suma en 
		$\mathbb{Z}_{2}$. La existencia de elemento neutro es clara, 
		pues bastará considerar el vector nulo. La existencia de 
		opuesto también es inmediata, ya que todo elemento es opuesto 
		de sí mismo. Finalmente, como la suma en $\mathbb{Z}_{2}$ es 
		conmutativa, se sigue que $(C_{p}(\text{{\Large $\nu$}}), +)$
		es abeliano.
	\end{proof}

	En segundo lugar, y habiendo definido los grupos de p-cadenas, pasamos
	a hacer un estudio más detallado de la aplicación <<borde>> definida 
	en \ref{def:borde}. Vamos con su definición:

	\begin{defi}
		Sea {\Large $\nu$} un complejo simplicial abstracto, $\sigma 
		\in \text{{\Large $\nu$}}$ y $\sigma = \{u_{1},...,u_{p}\}$. 
		Definimos el \textit{homomorfismo borde para un símplice}
		como:
		$$
		B_{p}(\sigma)=\displaystyle 
		\sum_{j=0}^{p}\{u_{1},...,\widehat{u_{j}},...,u_{p}\}
		$$
 		Donde $\widehat{u_{j}}$ indica que omitimos $u_{j}$. Notemos que este
		homomorfismo puede extenderse para cadenas, en concreto:
	\begin{equation}
		\label{def:borde_form}
		\begin{array}{lll}
			\partial_{p}:C_{p}(\text{{\Large $\nu$}}) & 
				\rightarrow & C_{p-1}(\text{{\Large $\nu$}})
				\\[3pt] 
			\multicolumn{1}{r}{c=\sum\sigma_{i}} & \mapsto & 
			\partial_{p}(c)=\sum B_{p}(\sigma_{i})
		\end{array}
	\end{equation}
	A $\partial_{p}$ lo llamaremos \textit{homomorfismo borde para 
	cadenas}, aunque por simplicidad nos referiremos a él como 
	\textit{homomorfismo borde}.
	
	A los elementos de $Im(\partial_{p})$ los llamaremos 
	\textit{(p-1)-bordes}, y a los elementos de $Ker(\partial_{p})$, 
	\textit{p-ciclos}.
	\end{defi}
	\begin{proof}
		Vamos a probar que $\partial_{p}$ es, en efecto, un 
		homomorfismo.

		Sean $\sigma,\tau \in \text{{\Large $\nu$}}_{p}$ tales que
		$\sigma = \{u_{1},...,u_{p}\}$ y $\tau = \{w_{1},...,w_{p}\}$.

		$B_{p}(\sigma)+B_{p}(\tau)=\displaystyle 
		\sum_{j=0}^{p}\{u_{1},...,\widehat{u_{j}},...,u_{p}\} + 
		\displaystyle \sum_{j=0}^{p}\{w_{1},...,\widehat{w_{j}},...,
		w_{p}\}=\displaystyle \sum_{i=0}^{p}\sum_{j=0}^{p}\{u_{1} + 
		w_{1},...,\widehat{u_{i}} + \widehat{w_{j}},...,u_{p}+w_{p}\}=
		B_{p}(\sigma+\tau)$. 

		Esto prueba que $B_{p}$ conmuta con la suma para 
		símplices. Se sigue que $\partial_{p}$ conmuta 
		para cadenas.

		Ahora, $0=B_{p}(\sigma)+B_{p}(\sigma)=
		B_{p}(\sigma + \sigma)=B_{p}(0)$. Esto implica 
		que $B_{p}$ deja fijo el símplice neutro. Al igual que
		antes, esta propiedad se extiende para cadenas.

		Finalmente, $0=B_{p}(0)=B_{p}(\sigma - \sigma)=
		B_{p}(\sigma)+B_{p}(-\sigma)$ y sumando 
		$-B_{p}(\sigma)$ a ambos lados de la ecuacion se sigue 
		que $B_{p}$ conmuta con el opuesto. Una vez más, este 
		hecho se extiende a cadenas.
	\end{proof}

	Este homomorfismo tiene propiedades muy interesantes, entre ellas:

	\begin{prop}
		Sea $\partial_{p}$ el homomorfismo borde definido en 
	   	\ref{def:borde_form}. Entonces $Im(\partial_{p})$ es subgrupo 
		de $C_{p-1}(\text{{\Large $\nu$}})$ y $Ker(\partial_{p})$ es 
		subgrupo de $C_{p}(\text{{\Large $\nu$}})$. Más aún, ambos son
		subgrupos normales de $C_{p-1}(\text{{\Large $\nu$}})$, 
		$C_{p-1}(\text{{\Large $\nu$}})$ respectivamente.
	\end{prop}
	\begin{proof}
		Vamos a probar ambos hechos por separado:
		\begin{itemize}
			\item Probaremos primero que $Im(\partial_{p})$ es subgrupo:

			Sean $a,b \in Im(\partial_{p})$ tales que $a=\partial_{p}(c) 
			\text{ y } b=\partial_{p}(d), c,d \in 
			C_{p}(\text{{\Large $\nu$}})$. 

			Entonces $a+b=\partial_{p}(c)+\partial_{p}(d)=
			\partial_{p}(c+d)$. Esto implica que $Im(\partial_{p})$ es 
			cerrado para la suma.

			Ahora, $0=\partial_{p}(0)=\partial_{p}(c+c)=
			\partial_{p}(c)+\partial_{p}(c)=a+a$. Esto implica que 
			$Im(\partial_{p})$ es cerrado para opuestos.

			Se sigue que $Im(\partial_{p})\leq 
			C_{p-1}(\text{{\Large $\nu$}})$.
			
			\item Probemos ahora que $Ker(\partial_{p})$ es 
			subgrupo: 
				
			Al igual que antes, sean $a,b \in Ker(\partial_{p})$.

			Entonces $0=\partial_{p}(a)+\partial_{p}(b)=
			\partial_{p}(a+b)$. Esto prueba que 
			$Ker(\partial_{p})$ es cerrado para la suma.

			Ahora, $0=\partial_{p}(0)=\partial_{p}(a-a)=
			\partial_{p}(a)+\partial_{p}(-a)=\partial_{p}(-a)$. 
			Esto prueba que $Ker(\partial_{p})$ es cerrado para 
			opuestos.

			Se sigue que $Ker(\partial_{p})\leq 
			C_{p}(\text{{\Large $\nu$}})$.
		\end{itemize}
		En virtud de la proposición \ref{prop:abel} y lo ya probado, 
		se concluye la normalidad.
	\end{proof}

	

	Además de la propiedad anterior, y tal y como vimos en la subsección 
	anterior, el homomorfismo borde tiene la propiedad fundamental de que 
	$\partial_{p}\circ \partial_{p+1}=0$. Este hecho implica que 
	$Im(\partial_{p+1}) \subset Ker(\partial_{p})$. Por lo tanto, podemos 
	considerar el cociente entre ambos grupos: $Ker(\partial_{p})/
	Im(\partial_{p+1})$. Este cociente constituye una de las piezas clave
	del presente trabajo:

	\begin{defi}
		\label{defi:homology}
		Sea $p \in \mathbb{N}\cup\{0\}$ y {\Large $\nu$} un complejo 
		simplicial. Definimos el \textit{p-ésimo grupo de homología} 
		de {\Large $\nu$} como el grupo cociente $Ker(\partial_{p})/
		Im(\partial_{p+1})$, donde $\partial_{p}$ está definida como
		en \ref{def:borde_form}. Lo denotaremos por $H_{p}(\text{
		{\Large $\nu$}})$.

		A su orden, $|H_{p}(\text{{\Large $\nu$}})|=
		|Ker(\partial_{p})|-|Im(\partial_{p+1})|$, lo 
		llamaremos \textit{p-ésimo número de Betti}, y lo denotaremos
		por $\beta_{p}(\text{{\Large $\nu$}})$.
	\end{defi}

	Intuitivamente, los p-ciclos que no son p-bordes representan agujeros
	p-dimensionales. Por lo tanto, $\beta_{p}(\text{{\Large $\nu$}})$ 
	representa el número de p-agujeros de {\Large $\nu$}. Además, notemos 
	que si $dim\text{{\Large $\nu$}}=n$, entonces $\forall p >n 
	\hspace{0.25cm} H_{p}(\text{{\Large $\nu$}})=\emptyset$, pues {\Large 
	$\nu$}$=\emptyset$.

	Ahora veamos un ejemplo en el que calculamos los números de Betti dado 
	un complejo simplicial abstracto.

	\begin{ejem}
		Supongamos el siguiente complejo simplicial abstracto:
		\begin{equation*} 
			\text{{\Large $\nu$}}=\{\{a\},\{b\},\{c\},\{d\},\{e\},
			\{a,b\},\{a,c\},\{a,d\},\{b,c\},\{c,d\},\{a,b,c\}\}
		\end{equation*}
		Construimos la secuencia de grupos de cadenas asociados:
		\begin{equation*}
			 \left.
			\begin{array}{ccccccccc}
				 &  &  & \partial_{2} &  & 
				\partial_{1} &  & \partial_{0} & \\ 
				\emptyset & \longrightarrow & C_{2}(
				\text{{\Large $\nu$}}) & 
				\longrightarrow & C_{1}(\text{{\Large $\nu$}}) 
						& \longrightarrow 
				& C_{0}(\text{{\Large $\nu$}}) & 
				\longrightarrow & \emptyset 
			\end{array}
			\right. 
		\end{equation*}
		Calculamos $\partial_{2}$ y $\partial_{1}$, y los expresamos 
		de manera matricial:
		\begin{equation*}
			\partial_{2}=
			\begin{pmatrix}
			1 \\
			1 \\
			0 \\
			1 \\
			0
			\end{pmatrix}
			\hspace{1cm}
			\partial_{1}=
			\begin{pmatrix}
			1 & 1 & 1 & 0 & 0\\
			1 & 0 & 0 & 1 & 0\\
			0 & 1 & 0 & 1 & 1\\
			0 & 0 & 1 & 0 & 1\\
			0 & 0 & 0 & 0 & 0
			\end{pmatrix}
		\end{equation*}
		Ahora para calcular $\beta_{0}(\text{{\Large $\nu$}}) 
		\text{ y } \beta_{1}(\text{{\Large $\nu$}})$ bastará
		calcular el rango de las anteriores matrices. Observamos que:
		\begin{equation*}
			\partial_{1}=
			\begin{pmatrix}
			1 & 1 & 1 & 0 & 0\\
			\hlightr{1} & 0 & 0 & 1 & 0\\
			0 & \hlightr{1} & 0 & 1 & 1\\
			0 & 0 & \hlightr{1} & 0 & 1\\
			0 & 0 & 0 & 0 & 0
			\end{pmatrix}
		\end{equation*}
		Con lo que, $dimIm(\partial_{1})=3 \text{ y } 
		dimKer(\partial_{1})=2$, y por lo tanto, $\beta_{1}(\text{
		{\Large $\nu$}})=1$ y $\beta_{0}(\text{{\Large $\nu$}})=2$. La
		representación gráfica de {\Large $\nu$} en $\mathbb{R}^{2}$
		nos queda:
		\begin{figure}[H]
			\label{fig:homs}
			\centering
			\begin{tikzpicture}
				%Nodes
				\coordinate      (a) 	at 	(0,0);
				\coordinate      (b) 	at 	(2,0);
				\coordinate      (c) 	at 	(2,2);
				\coordinate      (d) 	at 	(0,2);
				\coordinate      (e) 	at 	(4,1);
				
				%Lines
				\draw[thick] (a) -- (c);
				\draw[thick] (a) -- (b);
				\draw[thick] (a) -- (d);
				\draw[thick] (b) -- (c);
				\draw[thick] (d) -- (c);


				\fill[black!20, draw=black, thick] (a) -- (c) -- (b) -- cycle;
				\fill[black!20, draw=black, thick] (a) circle (3pt) node[black, left] {a};
				\fill[black!20, draw=black, thick] (b) circle (3pt) node[black, right]  {b};
				\fill[black!20, draw=black, thick] (c) circle (3pt) node[black, right] {c};
				\fill[black!20, draw=black, thick] (d) circle (3pt) node[black, left] {d};
				\fill[black!20, draw=black, thick] (e) circle (3pt) node[black, right] {e};

			\end{tikzpicture}
			\caption{Representación geométrica del complejo 
			simplicial {\Large $\nu$}.}
		\end{figure}
		Tal y como ya hemos comentado, los números de Betti nos 
		cuentan los agujeros p-dimensionales. En este caso, si 
		observamos la representación anterior, vemos que tenemos un 
		agujero 1-dimensional y dos componentes conexas, que se 
		corresponde con los números de Betti que hemos calculado. 

		Notemos que, al igual que en el ejemplo anterior, si 
		trabajamos sobre otro cuerpo que no sea $\mathbb{Z}_{2}$, los 
		rangos de las matrices podrían ser distintos. En este caso, si
		trabajamos sobre $\mathbb{Q}$, el rango de $\partial_{1}$ es 
		4. Esto afecta a los números de Betti y perjudica la 
		eficiencia computacional de los algoritmos empleados para su 
		cálculo.
	\end{ejem}
	
	Al igual que en la subsección anterior, veamos como podemos definir 
	morfismos, de manera más general, entre los objetos que estamos 
	manejando.
	
	Consideremos una aplicación entre complejos simpliciales, $f:\text{
	{\Large $\nu$}}\rightarrow\text{{\Large $\nu$}}'$. Aplicando el mismo 
	razonamiento que para la definición del homomorfismo borde, tenemos 
	que $f$ induce un homomorfismo entre grupos de cadenas :
	\begin{equation}
		\label{hom:induc}
		\left.
		\begin{array}{lll}
			\overline{f_{p}}:C_{p}(\text{{\Large $\nu$}}) & 
				\rightarrow & C_{p}(\text{{\Large $\nu$}}')
				\\[3pt] 
			\multicolumn{1}{r}{c=\displaystyle \sum_{\mathclap{
			\sigma \in \text{{\Large $\nu$}$_{p}$}}}\sigma} & 
			\mapsto & 
			\overline{f_{p}}(c)=\displaystyle \sum_{\mathclap{
			f(\sigma) \in \text{{\Large $\nu$}$_{p}'$}}}f(\sigma)
		\end{array}
		\right. 
	\end{equation}
	Además, tal $f$ nos permite construir la secuencia:
	\begin{equation}
		\label{hom: gruphom}
		 \left.
		\begin{array}{ccccccccccccc}
			 & & & \partial_{p} &  & 
			\partial_{p-1} &  & \partial_{2}&  & \partial_{1}&  & 
			\partial_{0} & \\ 
			\emptyset & \rightarrow & C_{p}(
			\text{{\Large $\nu$}}) & \rightarrow & C_{p-1}(
			\text{{\Large $\nu$}}) & \rightarrow &\cdots & 
			\rightarrow & C_{1}(
			\text{{\Large $\nu$}})& \rightarrow & C_{0}(
			\text{{\Large $\nu$}})& \rightarrow & \emptyset\\[3pt]

			 & & \downarrow \overline{f_{p}}& & \downarrow 
			\overline{f_{p-1}}& 
			 & & & \downarrow \overline{f_{1}}
			 & & \downarrow \overline{f_{0}} & & \\ [3pt]
			\emptyset & \rightarrow & C_{p}(
			\text{{\Large $\nu$}}') & \rightarrow & C_{p-1}(
			\text{{\Large $\nu$}}') & \rightarrow &\cdots & 
			\rightarrow & C_{1}(
			\text{{\Large $\nu$}}')& \rightarrow & C_{0}(
			\text{{\Large $\nu$}}')& \rightarrow & \emptyset \\
			 & & & \partial_{p}' &  & 
			\partial_{p-1}' &  & \partial_{2}' &  & \partial_{1}'&
					& \partial_{0}' &
		\end{array}
		\right. 
	\end{equation}
	De esta secuencia observamos que: 
	\begin{equation*}
		\overline{f_{p-1}}\circ\partial_{p}=
		\partial_{p}'\circ\overline{f_{p}} 
	\end{equation*}
	En consecuencia, $\overline{f_{p}}$ induce un 
	homomorfismo entre grupos de homología:	
		\begin{align*}
			\left.
			\begin{array}{l}
				f_{p}:H_{p}(\text{{\Large $\nu$}})\rightarrow 
				H_{p}(\text{{\Large $\nu$}}')\\[3pt] 
				\hspace{1.35cm} [c] \mapsto [\overline{f_{p}
				(c)}]
			\end{array}
			\right.
		\end{align*}
	Concluimos que, dada una aplicación $f$ entre complejos simpliciales, 
	siempre es posible asociarle una aplicación $f_{p}$ entre grupos de 
	homología.
	
	\begin{remark}
		Este propiedad es muy importante, de hecho, se conoce como 
		\emph{funtorialidad} y pertenece al ámbito de la teoría de 
		categorías que queda fuera del alcance del presente trabajo. 
		Sin embargo, observemos que esta propiedad es la responsable 
		de que podamos ver $C_{p}(\text{{\Large $\nu$}})$ como grupo
		o como espacio vectorial según nos convenga.
	\end{remark}

	Si bien los grupos de homología de un complejo simplicial abstracto 
	nos aportan mucha información acerca de sus características 
	topológicas, esta información tiene bastante margen de mejora pues no
	nos dice nada de la variable <<tiempo>>. Pero, ¿Cómo introducimos la 
	noción de tiempo en un complejo simplicial abstracto? Esta pregunta
	motiva la siguiente definición.

	\begin{defi}
		Sea {\Large $\nu$} un complejo simplicial abstracto finito. 
		Consideremos la secuencia $ \text{{\Large $\nu$}$_{1}$} 
		\subset \text{{\Large $\nu$}$_{2}$} \subset \cdots \subset
		\text{{\Large $\nu$}$_{k-1}$} \subset 
		\text{{\Large $\nu$}$_{k}$} = \text{{\Large $\nu$}}$ de 
		subcomplejos simpliciales cualesquiera de {\Large $\nu$}. A
		{\Large $\nu$} junto con su secuencia de subcomplejos 
		simpliciales encajados lo llamaremos \textit{complejo 
		simplicial filtrado}. 
	\end{defi}

	Esta noción nos habilita la variable <<tiempo>>, pues nos permite 
	preguntarnos en que momento de la secuencia aparecerá una cierta 
	característica topológica y cuanto <<tiempo>> sobrevivirá dicha 
	característica.

	Hay muchas maneras de construir la secuencia complejos simpliciales, 
	por ejemplo, empleando el \emph{complejo simplicial de Čech}. Su 
	construcción se realiza de la siguiente manera:

	Sea {\Large $\nu$} un complejo simplicial y $\mathcal{U}$ un 
	cubrimiento de {\Large $\nu$}. Los p-símplices del complejo simplicial
	de Čech vendrán dados por la intersección no vacía de p+1 conjuntos de
	$\mathcal{U}$.

	Lo interesante de este método es que si $\mathcal{U}$ verifica ciertas
	condiciones, el \emph{Teorema del nervio} garantiza que el complejo de
	Čech recupera la homología de {\Large $\nu$}. Ahora bien, ¿Cómo 
	podemos capturar y visualizar esta nueva información? Empleando la 
	\emph{homología persistente}.

	\begin{defi}
	Sea $ \text{{\Large $\nu$}$_{1}$} 
		\subset \text{{\Large $\nu$}$_{2}$} \subset \cdots \subset
		\text{{\Large $\nu$}$_{k-1}$} \subset 
		\text{{\Large $\nu$}$_{k}$} = \text{{\Large $\nu$}}$ un 
		complejo simplicial filtrado. Definimos los \textit{p-ésimos
		grupos de homología persistente} como las imágenes de los 
		homomorfismos inducidos por la inclusión, $H_{p}^{i,j}=
		Imf_{p}^{i,j}$, con $0\leq i \leq j \leq k$.

		A su orden, $|H_{p}^{i,j}|$, lo llamaremos \textit{p-ésimo 
		número de Betti persistente} y lo denotaremos por 
		$\beta_{p}^{i,j}$.
	\end{defi}

	Los homomorfismos $f_{p}^{i,j}$ los definimos siguiendo la idea dada
	por la funtorialidad. Es decir, tendremos el diagrama:
	\begin{equation*}
		\resizebox{\textwidth}{!}{$ 
		\begin{array}{ccccccccccccc}
			 & & & \partial_{p}^{1} &  & 
			\partial_{p-1}^{1} &  & \partial_{2}^{1}&  & 
			\partial_{1}^{1}&  & 
			\partial_{0}^{1} & \\ 
			\emptyset & \rightarrow & C_{p}(
			\text{{\Large $\nu$}$_{1}$}) & \rightarrow & C_{p-1}(
			\text{{\Large $\nu$}$_{1}$}) & \rightarrow &\cdots & 
			\rightarrow & C_{1}(
			\text{{\Large $\nu$}$_{1}$})& \rightarrow & C_{0}(
			\text{{\Large $\nu$}$_{1}$})& \rightarrow & 
			\emptyset\\[3pt]

			& & \downarrow \overline{f_{p}^{1,2}}& \partial_{p}^{2} & 
			\downarrow \overline{f_{p-1}^{1,2}}& \partial_{p-1}^{2} 
			& & \partial_{2}^{2} & \downarrow \overline{f_{1}^{1,2}}
			& \partial_{1}^{2} & \downarrow \overline{f_{0}^{1,2}} & 
			\partial_{0}^{2} & \\ [3pt]	
			\emptyset & \rightarrow & C_{p}(
			\text{{\Large $\nu$}$_{2}$}) & \rightarrow & C_{p-1}(
			\text{{\Large $\nu$}$_{2}$}) & \rightarrow &\cdots & 
			\rightarrow & C_{1}(
			\text{{\Large $\nu$}$_{2}$})& \rightarrow & C_{0}(
			\text{{\Large $\nu$}$_{2}$})& \rightarrow & 
			\emptyset \\[5pt]
			
			\vdots & \vdots & \vdots & \vdots & \vdots & \vdots & 
			\vdots & \vdots & \vdots & \vdots & \vdots & \vdots & 
			\vdots \\[5pt]
			
			& & & \partial_{p}^{k-1} &  & 
			\partial_{p-1}^{k-1} &  & \partial_{2}^{k-1}&  & 
			\partial_{1}^{k-1}&  & 
			\partial_{0}^{k-1} & \\ 
			\emptyset & \rightarrow & C_{p}(
			\text{{\Large $\nu$}$_{k-1}$}) & \rightarrow & C_{p-1}(
			\text{{\Large $\nu$}$_{k-1}$}) & \rightarrow &\cdots & 
			\rightarrow & C_{1}(
			\text{{\Large $\nu$}$_{k-1}$})& \rightarrow & C_{0}(
			\text{{\Large $\nu$}$_{k-1}$})& \rightarrow & 
			\emptyset\\[3pt]

			& & \downarrow \overline{f_{p}^{k-1,k}}& \partial_{p}^{k} & 
			\downarrow \overline{f_{p-1}^{k-1,k}}& \partial_{p-1}^{k} 
			& & \partial_{2}^{k} & \downarrow \overline{f_{1}^{k-1,k}}
			& \partial_{1}^{k} & \downarrow \overline{f_{0}^{k-1,k}} & 
			\partial_{0}^{k} & \\ [3pt]	
			\emptyset & \rightarrow & C_{p}(
			\text{{\Large $\nu$}$_{k}$}) & \rightarrow & C_{p-1}(
			\text{{\Large $\nu$}$_{k}$}) & \rightarrow &\cdots & 
			\rightarrow & C_{1}(
			\text{{\Large $\nu$}$_{k}$})& \rightarrow & C_{0}(
			\text{{\Large $\nu$}$_{k}$})& \rightarrow & \emptyset \\
		\end{array}$}
	\end{equation*}
	Donde los homomorfismos $\overline{f_{p}^{i,j}}$ entre grupos de 
	cadenas vienen inducidos por el homomorfismo inclusión $f^{i,j}: 
	\text{{\Large $\nu$}$_{i}$} \xhookrightarrow{} 
	\text{{\Large $\nu$}$_{j}$}$ con $0\leq i \leq j \leq k$, como en 
	\ref{hom:induc}. Ahora, aplicando el mismo razonamiento que en 
	\ref{hom: gruphom} definimos los homomorfismos entre grupos de 
	homología $f^{i,j}_{p}$.

	Ahora que ya tenemos una herramienta que nos captura las 
	características topológicas junto con la variable <<tiempo>>, en un 
	complejo simplicial abstracto filtrado, necesitamos una manera gŕafica 
	de visualizar esta información. Para ello, emplearemos los  
	\emph{diagramas de barras} y los \emph{diagramas de persistencia}.
	
	Para construir los diagramas de barras, dibujamos $\beta_{p}^{i,i+1}$ 
	puntos para la i-ésima filtración, y los conectamos con los 
	$\beta_{p}^{i+1,i+2}$ puntos de la filtración i+1 atendiendo al 
	siguiente crietrio: unimos los puntos $a$ de la filtración i y $b$ de
	la filtración i+1, si la clase del elemento que genera a $a$ es 
	preimagen por $f_{p}^{i,i+1}$ de la clase del elemento que genera a 
	$b$. Si la clase del elemento que genera a $a$ es enviada a 0 por 
	$f_{p}^{i,i+1}$ dibujaremos una linea que sale de $a$ en la filtración
	i hasta la filtración i+1. 

	En este caso, diremos que la clase del 
	elemento que genera a $a$ \emph{muere} en la filtración i+1. Si la 
	preimagen de la clase del elemento que genera a $a$ por 
	$f_{p}^{i-1,i}$ es el 0, diremos que la clase \emph{nace} en la 
	filtración i.

	Para los diagramas de persistencia, dibujaremos $\sum_{p}
	\beta_{p}^{i,j}$ puntos cuyas coordenadas en $\mathbb{R}^{2}$ vendrán 
	dadas por su filtración de nacimiento y de muerte en ese orden. 

	\begin{remark}
		Estos diagramas dependen de la elección de la base de los 
		espacios vectoriales subyacentes. Una mala elección nos 
		llevará a diagramas ilegibles. Por suerte, tenemos un 
		resultado teórico que nos garantiza la existencia de una 
		<<buena>> base.
	\end{remark}

	Veamos un ejemplo ilustrativo de estos conceptos:

	\begin{ejem}
	Consideremos el siguiente complejo simplicial filtrado:  
	$ \text{{\Large $\nu$}$_{1}$} 
		\subset \text{{\Large $\nu$}$_{2}$} \subset
		\text{{\Large $\nu$}$_{3}$} \subset 
		\text{{\Large $\nu$}$_{4}$} = \text{{\Large $\nu$}}$. Donde:
	\begin{itemize}
		
		\item
			$\text{{\Large $\nu$}$_{1}$}=\{\{a\},\{b\},\{c\},\{d\}
			,\{a,b\}\}$
		\item
			$\text{{\Large $\nu$}$_{2}$}=\{\{a\},\{b\},\{c\},
				\{d\},\{e\},\{f\},\{a,b\},\{a,c\},\{b,c\}\}$
		\item 
			$\text{{\Large $\nu$}$_{3}$}=\{\{a\},\{b\},\{c\},
				\{d\}, \{e\},\{f\},\{a,b\},\{a,c\},\{a,e\},
				\{b,c\},\{b,f\},\{c,f\},\{c,e\},$\\
			$\{a,b,c\}\}$
		\item 
			$\text{{\Large $\nu$}$_{4}$}=\{\{a\},\{b\},\{c\},
				\{d\},\{e\},\{f\},\{a,b\},\{a,c\},\{a,e\},
				\{b,c\},\{b,f\},\{c,f\},\{c,e\},$\\
				$\{a,b,c\},\{a,c,e\}\}$
	\end{itemize}
	Veamos su representación gráfica en $\mathbb{R}^{2}$:
	\begin{figure}[H]
		\fbox{\minipage{0.225\textwidth}
			\begin{figure}[H]
				\resizebox{\textwidth}{!}{

			\begin{tikzpicture}
				%Nodes
				\node 		 (label) at (2,5) {{\Large $\nu$}$_{1}$};
				\coordinate      (a) 	at 	(0,0);
				\coordinate      (b) 	at 	(2,0);
				\coordinate      (c) 	at 	(2,2);
				\coordinate      (d) 	at 	(4,2);
				\coordinate      (e) 	at 	(2,4);
				\coordinate      (f) 	at 	(4,0);
				
				%Lines
				\draw[thick] (a) -- (b);


				\fill[black!20, draw=black, thick] (a) circle (3pt) node[black, below] {a};
				\fill[black!20, draw=black, thick] (b) circle (3pt) node[black, below]  {b};
				\fill[black!20, draw=black, thick] (c) circle (3pt) node[black, right] {c};
				\fill[black!20, draw=black, thick] (d) circle (3pt) node[black, right] {d};

		\end{tikzpicture}}
			\end{figure}	
		\endminipage}
		\fbox{\minipage{0.225\textwidth}
			\begin{figure}[H]
				\resizebox{1.0\textwidth}{!}{
				\begin{tikzpicture}
					%Nodes
					\node 		 (label) at (2,5) {{\Large $\nu$}$_{2}$};
					\coordinate      (a) 	at 	(0,0);
					\coordinate      (b) 	at 	(2,0);
					\coordinate      (c) 	at 	(2,2);
					\coordinate      (d) 	at 	(4,2);
					\coordinate      (e) 	at 	(2,4);
					\coordinate      (f) 	at 	(4,0);
					
					%Lines
					\draw[thick] (a) -- (c);
					\draw[thick] (a) -- (b);
					\draw[thick] (b) -- (c);

					\fill[black!20, draw=black, thick] (a) circle (3pt) node[black, below] {a};
					\fill[black!20, draw=black, thick] (b) circle (3pt) node[black, below]  {b};
					\fill[black!20, draw=black, thick] (c) circle (3pt) node[black, right] {c};
					\fill[black!20, draw=black, thick] (d) circle (3pt) node[black, right] {d};
					\fill[black!20, draw=black, thick] (e) circle (3pt) node[black, right] {e};
					\fill[black!20, draw=black, thick] (f) circle (3pt) node[black, right] {f};

				\end{tikzpicture}}
			\end{figure}	
		\endminipage}
		\fbox{\minipage{0.225\textwidth}
			\begin{figure}[H]
				\resizebox{1.0\textwidth}{!}{
				\begin{tikzpicture}
					%Nodes
					\node 		 (label) at (2,5) {{\Large $\nu$}$_{3}$};
					\coordinate      (a) 	at 	(0,0);
					\coordinate      (b) 	at 	(2,0);
					\coordinate      (c) 	at 	(2,2);
					\coordinate      (d) 	at 	(4,2);
					\coordinate      (e) 	at 	(2,4);
					\coordinate      (f) 	at 	(4,0);
					
					%Lines
					\draw[thick] (a) -- (e);
					\draw[thick] (c) -- (f);
					\draw[thick] (c) -- (e);
					\draw[thick] (b) -- (f);

					\fill[black!20, draw=black, thick] (a) -- (b) -- (c) -- cycle;
					\fill[black!20, draw=black, thick] (a) circle (3pt) node[black, below] {a};
					\fill[black!20, draw=black, thick] (b) circle (3pt) node[black, below]  {b};
					\fill[black!20, draw=black, thick] (c) circle (3pt) node[black, right] {c};
					\fill[black!20, draw=black, thick] (d) circle (3pt) node[black, right] {d};
					\fill[black!20, draw=black, thick] (e) circle (3pt) node[black, right] {e};
					\fill[black!20, draw=black, thick] (f) circle (3pt) node[black, right] {f};

				\end{tikzpicture}}
			\end{figure}	
		\endminipage}
		\fbox{\minipage{0.225\textwidth}
			\begin{figure}[H]
				\resizebox{1.0\textwidth}{!}{
				\begin{tikzpicture}
					%Nodes
					\node 		 (label) at (2,5) {{\Large $\nu$}$_{4}$};
					\coordinate      (a) 	at 	(0,0);
					\coordinate      (b) 	at 	(2,0);
					\coordinate      (c) 	at 	(2,2);
					\coordinate      (d) 	at 	(4,2);
					\coordinate      (e) 	at 	(2,4);
					\coordinate      (f) 	at 	(4,0);
					
					%Lines
					\draw[thick] (c) -- (f);
					\draw[thick] (b) -- (f);

					\fill[black!20, draw=black, thick] (a) -- (b) -- (c) -- cycle;
					\fill[black!20, draw=black, thick] (a) -- (e) -- (c) -- cycle;
					\fill[black!20, draw=black, thick] (a) circle (3pt) node[black, below] {a};
					\fill[black!20, draw=black, thick] (b) circle (3pt) node[black, below]  {b};
					\fill[black!20, draw=black, thick] (c) circle (3pt) node[black, right] {c};
					\fill[black!20, draw=black, thick] (d) circle (3pt) node[black, right] {d};
					\fill[black!20, draw=black, thick] (e) circle (3pt) node[black, right] {e};
					\fill[black!20, draw=black, thick] (f) circle (3pt) node[black, right] {f};

				\end{tikzpicture}}
			\end{figure}	
		\endminipage}
	\end{figure}
	Ahora vamos a dibujar los diagramas de barras correspondientes:
	\begin{figure}[H]
		\fbox{\minipage{0.5\textwidth}
			\begin{figure}[H]
				\resizebox{\textwidth}{!}{
				
				\begin{tikzpicture}[scale=2.5]
				%Nodes
				\node 		 (label) at (2,3) {Grado 0};
				\node 		 (label) at (2,-0.5) {Filtración};
				\coordinate      (n0) 	at 	(0,0);
				\coordinate      (n1) 	at 	(1,0);
				\coordinate      (n2) 	at 	(2,0);
				\coordinate      (n3) 	at 	(3,0);
				\coordinate      (n4) 	at 	(4,0);
				\coordinate      (n5) 	at 	(0,0.5);
				\coordinate      (n6) 	at 	(1,0.5);
				\coordinate      (n7) 	at 	(2,0.5);
				\coordinate      (n8) 	at 	(3,0.5);
				\coordinate      (n9) 	at 	(4,0.5);
				\coordinate      (n10) 	at 	(0,1);
				\coordinate      (n11) 	at 	(1,1);
				\coordinate      (n12) 	at 	(2,1);
				\coordinate      (n13) 	at 	(3,1);
				\coordinate      (n14) 	at 	(4,1);
				\coordinate      (n15) 	at 	(0,1.5);
				\coordinate      (n16) 	at 	(1,1.5);
				\coordinate      (n17) 	at 	(2,1.5);
				\coordinate      (n18) 	at 	(3,1.5);
				\coordinate      (n19) 	at 	(4,1.5);
				\coordinate      (n20) 	at 	(0,2);
				\coordinate      (n21) 	at 	(1,2);
				\coordinate      (n22) 	at 	(2,2);
				\coordinate      (n23) 	at 	(3,2);
				\coordinate      (n24) 	at 	(4,2);
				\coordinate      (n25) 	at 	(0,2.5);
				\coordinate      (n26) 	at 	(1,2.5);
				\coordinate      (n27) 	at 	(2,2.5);
				\coordinate      (n28) 	at 	(3,2.5);
				\coordinate      (n29) 	at 	(4,2.5);
				
				%Lines
				\draw[thick] (n0) -- (n3);
				\draw[thick,->] (n3) -- (n4);
				\draw[thick] (0,3pt) -- (0,-3pt) node[anchor=north] {1};
				\draw[thick] (1,3pt) -- (1,-3pt) node[anchor=north] {2};
				\draw[thick] (2,3pt) -- (2,-3pt) node[anchor=north] {3};
				\draw[thick] (3,3pt) -- (3,-3pt) node[anchor=north] {4};


				\draw[thick,->,color=blue] (n5) -- (n9);
				\draw[thick,color=blue] (n10) -- (n11);
				\draw[thick,->,color=blue] (n15) -- (n19);
				\draw[thick,color=blue] (n21) -- (n22);
				\draw[thick,color=blue] (n26) -- (n27);

		\end{tikzpicture}}
			\end{figure}	
		\endminipage}
		\fbox{\minipage{0.5\textwidth}
			\begin{figure}[H]
				\resizebox{\textwidth}{!}{
				\begin{tikzpicture}[scale=2.5]
					%Nodes
					\node 		 (label) at (2,3) {Grado 1};
					\node 		 (label) at (2,-0.5) {Filtración};
				\coordinate      (n0) 	at 	(0,0);
				\coordinate      (n1) 	at 	(1,0);
				\coordinate      (n2) 	at 	(2,0);
				\coordinate      (n3) 	at 	(3,0);
				\coordinate      (n4) 	at 	(4,0);
				\coordinate      (n5) 	at 	(0,0.5);
				\coordinate      (n6) 	at 	(1,0.5);
				\coordinate      (n7) 	at 	(2,0.5);
				\coordinate      (n8) 	at 	(3,0.5);
				\coordinate      (n9) 	at 	(4,0.5);
				\coordinate      (n10) 	at 	(0,1);
				\coordinate      (n11) 	at 	(1,1);
				\coordinate      (n12) 	at 	(2,1);
				\coordinate      (n13) 	at 	(3,1);
				\coordinate      (n14) 	at 	(4,1);
				\coordinate      (n15) 	at 	(0,1.5);
				\coordinate      (n16) 	at 	(1,1.5);
				\coordinate      (n17) 	at 	(2,1.5);
				\coordinate      (n18) 	at 	(3,1.5);
				\coordinate      (n19) 	at 	(4,1.5);
				\coordinate      (n20) 	at 	(0,2);
				\coordinate      (n21) 	at 	(1,2);
				\coordinate      (n22) 	at 	(2,2);
				\coordinate      (n23) 	at 	(3,2);
				\coordinate      (n24) 	at 	(4,2);
				\coordinate      (n25) 	at 	(0,2.5);
				\coordinate      (n26) 	at 	(1,2.5);
				\coordinate      (n27) 	at 	(2,2.5);
				\coordinate      (n28) 	at 	(3,2.5);
				\coordinate      (n29) 	at 	(4,2.5);
				
				%Lines
				\draw[thick] (n0) -- (n3);
				\draw[thick,->] (n3) -- (n4);
				\draw[thick] (0,3pt) -- (0,-3pt) node[anchor=north] {1};
				\draw[thick] (1,3pt) -- (1,-3pt) node[anchor=north] {2};
				\draw[thick] (2,3pt) -- (2,-3pt) node[anchor=north] {3};
				\draw[thick] (3,3pt) -- (3,-3pt) node[anchor=north] {4};


				\draw[thick,color=red] (n6) -- (n7);
				\draw[thick,->,color=red] (n12) -- (n14);
				\draw[thick,color=red] (n17) -- (n18);

				\end{tikzpicture}}
			\end{figure}	
		\endminipage}
	\end{figure}
	Por último, visualizamos los diagramas de persistencia:
	\begin{figure}[H]
		\fbox{\minipage{0.5\textwidth}
			\begin{figure}[H]
				\resizebox{\textwidth}{!}{
				
				\begin{tikzpicture}[scale=2.5]
				%Nodes
				\node 		 (label) at (2,4) {Grado 0};
				\node 		 (label) at (2,-0.5) {Nacimiento};
				\node[rotate=90] 		 (label) at (-0.5,1.5) {Muerte};
				\coordinate      (n0) 	at 	(0,0);
				\coordinate      (n1) 	at 	(1,0);
				\coordinate      (n2) 	at 	(2,0);
				\coordinate      (n3) 	at 	(3,0);
				\coordinate      (n4) 	at 	(4,0);
				\coordinate      (n5) 	at 	(0,0.5);
				\coordinate      (n6) 	at 	(1,0.5);
				\coordinate      (n7) 	at 	(2,0.5);
				\coordinate      (n8) 	at 	(3,0.5);
				\coordinate      (n9) 	at 	(4,0.5);
				\coordinate      (n10) 	at 	(0,1);
				\coordinate      (n11) 	at 	(1,1);
				\coordinate      (n12) 	at 	(2,1);
				\coordinate      (n13) 	at 	(3,1);
				\coordinate      (n14) 	at 	(4,1);
				\coordinate      (n15) 	at 	(0,1.5);
				\coordinate      (n16) 	at 	(1,1.5);
				\coordinate      (n17) 	at 	(2,1.5);
				\coordinate      (n18) 	at 	(3,1.5);
				\coordinate      (n19) 	at 	(4,1.5);
				\coordinate      (n20) 	at 	(0,2);
				\coordinate      (n21) 	at 	(1,2);
				\coordinate      (n22) 	at 	(2,2);
				\coordinate      (n23) 	at 	(3,2);
				\coordinate      (n24) 	at 	(4,2);
				\coordinate      (n25) 	at 	(0,2.5);
				\coordinate      (n26) 	at 	(1,2.5);
				\coordinate      (n27) 	at 	(2,2.5);
				\coordinate      (n28) 	at 	(3,2.5);
				\coordinate      (n29) 	at 	(4,2.5);
				
				%Lines
				\draw[thick] (n0) -- (n3);
				\draw[thick,->] (n3) -- (n4);
				\draw[thick] (0,2pt) -- (0,-2pt) node[anchor=north] {1};
				\draw[thick] (1,2pt) -- (1,-2pt) node[anchor=north] {2};
				\draw[thick] (2,2pt) -- (2,-2pt) node[anchor=north] {3};
				\draw[thick] (3,2pt) -- (3,-2pt) node[anchor=north] {4};
				
				\draw[thick,->] (n0) -- (0,3.7);
				\draw[thick] (2pt,1) -- (-2pt,1) node[anchor=north] {2};
				\draw[thick] (2pt,2) -- (-2pt,2) node[anchor=north] {3};
				\draw[thick] (2pt,3) -- (-2pt,3) node[anchor=north] {4};
				\node[anchor=east] at (-0.05,3.5) {$\infty$};


				\draw[thick,color=blue] (n0) -- (4,3.5);
				\draw[thick] (0,3.5) -- (4,3.5);
				\fill[blue] (0,1) circle (1pt);
				\fill[blue] (1,2) circle (2pt);
				\fill[blue] (0,3.5) circle (2pt);

		\end{tikzpicture}}
			\end{figure}	
		\endminipage}
		\fbox{\minipage{0.5\textwidth}
			\begin{figure}[H]
				\resizebox{\textwidth}{!}{
				
				\begin{tikzpicture}[scale=2.5]
				%Nodes
				\node 		 (label) at (2,4) {Grado 1};
				\node 		 (label) at (2,-0.5) {Nacimiento};
				\node[rotate=90] 		 (label) at (-0.5,1.5) {Muerte};
				\coordinate      (n0) 	at 	(0,0);
				\coordinate      (n1) 	at 	(1,0);
				\coordinate      (n2) 	at 	(2,0);
				\coordinate      (n3) 	at 	(3,0);
				\coordinate      (n4) 	at 	(4,0);
				\coordinate      (n5) 	at 	(0,0.5);
				\coordinate      (n6) 	at 	(1,0.5);
				\coordinate      (n7) 	at 	(2,0.5);
				\coordinate      (n8) 	at 	(3,0.5);
				\coordinate      (n9) 	at 	(4,0.5);
				\coordinate      (n10) 	at 	(0,1);
				\coordinate      (n11) 	at 	(1,1);
				\coordinate      (n12) 	at 	(2,1);
				\coordinate      (n13) 	at 	(3,1);
				\coordinate      (n14) 	at 	(4,1);
				\coordinate      (n15) 	at 	(0,1.5);
				\coordinate      (n16) 	at 	(1,1.5);
				\coordinate      (n17) 	at 	(2,1.5);
				\coordinate      (n18) 	at 	(3,1.5);
				\coordinate      (n19) 	at 	(4,1.5);
				\coordinate      (n20) 	at 	(0,2);
				\coordinate      (n21) 	at 	(1,2);
				\coordinate      (n22) 	at 	(2,2);
				\coordinate      (n23) 	at 	(3,2);
				\coordinate      (n24) 	at 	(4,2);
				\coordinate      (n25) 	at 	(0,2.5);
				\coordinate      (n26) 	at 	(1,2.5);
				\coordinate      (n27) 	at 	(2,2.5);
				\coordinate      (n28) 	at 	(3,2.5);
				\coordinate      (n29) 	at 	(4,2.5);
				
				%Lines
				\draw[thick] (n0) -- (n3);
				\draw[thick,->] (n3) -- (n4);
				\draw[thick] (0,2pt) -- (0,-2pt) node[anchor=north] {1};
				\draw[thick] (1,2pt) -- (1,-2pt) node[anchor=north] {2};
				\draw[thick] (2,2pt) -- (2,-2pt) node[anchor=north] {3};
				\draw[thick] (3,2pt) -- (3,-2pt) node[anchor=north] {4};
				
				\draw[thick,->] (n0) -- (0,3.7);
				\draw[thick] (2pt,1) -- (-2pt,1) node[anchor=north] {2};
				\draw[thick] (2pt,2) -- (-2pt,2) node[anchor=north] {3};
				\draw[thick] (2pt,3) -- (-2pt,3) node[anchor=north] {4};
				\node[anchor=east] at (0,3.5) {$\infty$};


				\draw[thick,color=red] (n0) -- (4,3.5);
				\draw[thick] (0,3.5) -- (4,3.5);
				\fill[red] (2,3) circle (1pt);
				\fill[red] (1,2) circle (1pt);
				\fill[red] (2,3.5) circle (1pt);

		\end{tikzpicture}}
			\end{figure}	
		\endminipage}
	\end{figure}
	\end{ejem}

\end{document} 
